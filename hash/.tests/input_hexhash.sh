#!/bin/bash

# sha-2 tests  : https://tools.ietf.org/rfc/rfc6234.txt
# rmd160 tests : http://homes.esat.kuleuven.be/~bosselae/ripemd160.html#Outline

tests_arr()
{
    tests_raw

    # disabled tests : test3
    btests_sha224=( ${test1} ${test2_1} ${test4} )
    # disabled tests : ${test5:-(empty string)} test7_224 test9_224
    htests_sha224=( 07 ${test8_224} ${test10_224} )

    # disabled tests : test3
    btests_sha256=( ${test1} ${test2_1} ${test4} )
    # disabled tests : ${test5:-(empty string)} test7_256 test9_256
    htests_sha256=( 19 ${test8_256} ${test10_256} )

    # disabled tests : test3
    btests_sha384=( ${test1} ${test2_2} ${test4} )
    # disabled tests : ${test5:-(empty string)} test7_384 test9_384
    htests_sha384=( B9 ${test8_384} ${test10_384} )

    # disabled tests : test3
    btests_sha512=( ${test1} ${test2_2} ${test4} )
    # disabled tests : ${test5:-(empty string)} test7_512 test9_512
    htests_sha512=( D0 ${test8_512} ${test10_512} )

    # disabled tests : ${testr160_1:-(empty string)} testr160_9
    btests_rmd160=( "${testr160_2}" "${testr160_3}" "${testr160_4}" "${testr160_5}" "${testr160_6}" "${testr160_7}" "${testr160_8}" )
    # disabled tests :
    # htests_rmd160=( )

    # btests_hash160=( )
    htests_hash160=( ${testhash160_1} ${testhash160_2} ${testhash160_3} ${testhash160_4} ${testhash160_5} ${testhash160_6} ${testhash160_7} )

    # btests_hhash256=( )
    htests_hash256=( ${testhash256_1} ${testhash256_2} ${testhash256_3} ${testhash256_4} )
}

tests_ret()
{
    ret_sha224=( \
        '23097D223405D8228642A477BDA255B32AADBCE4BDA0B3F7E36C9DA7' \
        '75388B16512776CC5DBA5DA1FD890150B0C6455CB4F58B1952522525' \
        # '20794655980C91D8BBB4C1EA97618A4BF03F42581948B2EE4EE7AD67' \
        '567F69F168CD7844E65259CE658FE7AADFA25216E68ECA0EB7AB8262' \
        # 'E3B048552C3C387BCAB37F6EB06BB79B96A4AEE5FF27F51531A9551C' \
        '00ECD5F138422B8AD74C9799FD826C531BAD2FCABC7450BEE2AA8C2A' \
        # '1B01DB6CB4A9E43DED1516BEB3DB0B87B6D1EA43187462C608137150' \
        'DF90D78AA78821C99B40BA4C966921ACCD8FFB1E98AC388E56191DB1' \
        # '54BEA6EAB8195A2EB0A7906A4B4A876666300EEFBD1F3B8474F9CD57' \
        '0B31894EC8937AD9B91BDFBCBA294D9ADEFAA18E09305E9F20D5C3A4' )

    ret_sha256=( \
        'BA7816BF8F01CFEA414140DE5DAE2223B00361A396177A9CB410FF61F20015AD' \
        '248D6A61D20638B8E5C026930C3E6039A33CE45964FF2167F6ECEDD419DB06C1' \
        # 'CDC76E5C9914FB9281A1C7E284D73E67F1809A48A497200E046D39CCC7112CD0' \
        '594847328451BDFA85056225462CC1D867D877FB388DF0CE35F25AB5562BFBB5' \
        # 'D6D3E02A31A84A8CAA9718ED6C2057BE09DB45E7823EB5079CE7A573A3760F95' \
        '68AA2E2EE5DFF96E3355E6C7EE373E3D6A4E17F75F9518D843709C0C9BC3E3D4' \
        # '77EC1DC89C821FF2A1279089FA091B35B8CD960BCAF7DE01C6A7680756BEB972' \
        '175EE69B02BA9B58E2B0A5FD13819CEA573F3940A94F825128CF4209BEABB4E8' \
        # '3E9AD6468BBBAD2AC3C2CDC292E018BA5FD70B960CF1679777FCE708FDB066E9' \
        '97DBCA7DF46D62C8A422C941DD7E835B8AD3361763F7E9B2D95F4F0DA6E1CCBC' )

    ret_sha384=( \
        'CB00753F45A35E8BB5A03D699AC65007272C32AB0EDED1631A8B605A43FF5BED8086072BA1E7CC2358BAECA134C825A7' \
        '09330C33F71147E83D192FC782CD1B4753111B173B3B05D22FA08086E3B0F712FCC7C71A557E2DB966C3E9FA91746039' \
        # '9D0E1809716474CB086E834E310A4A1CED149E9C00F248527972CEC5704C2A5B07B8B3DC38ECC4EBAE97DDD87F3D8985' \
        '2FC64A4F500DDB6828F6A3430B8DD72A368EB7F3A8322A70BC84275B9C0B3AB00D27A5CC3C2D224AA6B61A0D79FB4596' \
        # '8D17BE79E32B6718E07D8A603EB84BA0478F7FCFD1BB93995F7D1149E09143AC1FFCFC56820E469F3878D957A15A3FE4' \
        'BC8089A19007C0B14195F4ECC74094FEC64F01F90929282C2FB392881578208AD466828B1C6C283D2722CF0AD1AB6938' \
        # 'D8C43B38E12E7C42A7C9B810299FD6A770BEF30920F17532A898DE62C7A07E4293449C0B5FA70109F0783211CFC4BCE3' \
        'C9A68443A005812256B8EC76B00516F0DBB74FAB26D665913F194B6FFB0E91EA9967566B58109CBC675CC208E4C823F7' \
        # '5860E8DE91C21578BB4174D227898A98E0B45C4C760F009549495614DAEDC0775D92D11D9F8CE9B064EEAC8DAFC3A297' \
        '4F440DB1E6EDD2899FA335F09515AA025EE177A79F4B4AAF38E42B5C4DE660F5DE8FB2A5B2FBD2A3CBFFD20CFF1288C0' )

    ret_sha512=( \
        'DDAF35A193617ABACC417349AE20413112E6FA4E89A97EA20A9EEEE64B55D39A2192992A274FC1A836BA3C23A3FEEBBD454D4423643CE80E2A9AC94FA54CA49F' \
        '8E959B75DAE313DA8CF4F72814FC143F8F7779C6EB9F7FA17299AEADB6889018501D289E4900F7E4331B99DEC4B5433AC7D329EEB6DD26545E96E55B874BE909' \
        # 'E718483D0CE769644E2E42C7BC15B4638E1F98B13B2044285632A803AFA973EBDE0FF244877EA60A4CB0432CE577C31BEB009C5C2C49AA2E4EADB217AD8CC09B' \
        '89D05BA632C699C31231DED4FFC127D5A894DAD412C0E024DB872D1ABD2BA8141A0F85072A9BE1E2AA04CF33C765CB510813A39CD5A84C4ACAA64D3F3FB7BAE9' \
        # 'D4EE29A9E90985446B913CF1D1376C836F4BE2C1CF3CADA0720A6BF4857D886A7ECB3C4E4C0FA8C7F95214E41DC1B0D21B22A84CC03BF8CE4845F34DD5BDBAD4' \
        '9992202938E882E73E20F6B69E68A0A7149090423D93C81BAB3F21678D4ACEEEE50E4E8CAFADA4C85A54EA8306826C4AD6E74CECE9631BFA8A549B4AB3FBBA15' \
        # 'ED8DC78E8B01B69750053DBB7A0A9EDA0FB9E9D292B1ED715E80A7FE290A4E16664FD913E85854400C5AF05E6DAD316B7359B43E64F8BEC3C1F237119986BBB6' \
        'CB0B67A4B8712CD73C9AABC0B199E9269B20844AFB75ACBDD1C153C9828924C3DDEDAAFE669C5FDD0BC66F630F6773988213EB1B16F517AD0DE4B2F0C95C90F8' \
        # '32BA76FC30EAA0208AEB50FFB5AF1864FDBF17902A4DC0A682C61FCEA6D92B783267B21080301837F59DE79C6B337DB2526F8A0A510E5E53CAFED4355FE7C2F1' \
        'C665BEFB36DA189D78822D10528CBF3B12B3EEF726039909C1A16A270D48719377966B957A878E720584779A62825C18DA26415E49A7176A894E7510FD1451F5' )

    ret_rmd160=( \
        # '9C1185A5C5E9FC54612808977EE8F548B2258D31' \
        '0BDC9D2D256B3EE9DAAE347BE6F4DC835A467FFE' \
        '8EB208F7E05D987A9B044A8E98C6B087F15A0BFC' \
        '5D0689EF49D2FAE572B881B123A85FFA21595F36' \
        'F71C27109C692C1B56BBDCEB5B9D2865B3708DBC' \
        '12A053384A9C0C88E405A06C27DCF49ADA62EB2B' \
        'B0E20B6E3116640286ED3A87A5713079B21F5189' \
        '9B752E45573D4B39F4DBD3323CAB82BF63326BFB' ) #\
        # '52783243C1697BDBE16D37F97F68F08325DC1528' )

    ret_hash160=( \
        '9965A3ED5863D7D882047107860DAB8109F9C874' \
        '05BF3A3AEA6335A3949C0A351FF3AFCBA884E125' \
        '2A37B3BDCA935152335C2097E5DA367DB24209CC' \
        'DCDF2F9892BFA1CB086530354EAB3BA078A2F090' \
        'A69BBE1855F2F0EE87AC0AE48082931EE22339DD' \
        'B169F2B0B866DB05900B93A5D76345F18D3AFB24' \
        'D0A9B94FB1AF00B7F9C1D4030D0DCA060546E4E1' )

    ret_hash256=( \
        '6FE28C0AB6F1B372C1A6A246AE63F74F931E8365E15A089C68D6190000000000' \
        '169E1E83E930853391BC6F35F605C6754CFEAD57CF8387639D3B4096C54F18F4' \
        '92617719A76134074357C03C1EE906719D02493B762455FAD1277FB6ECD2266A' \
        '8CF3E30B353DD9EAE3AC8B37863E6097A4127C2CDB86F8090000000000000000' )
}

tests_raw()
{
    test1="abc"
    test2_1="abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq"

    test2_2a="abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmn"
    test2_2b="hijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu"
    test2_2="${test2_2a}${test2_2b}"

    test3="a"

    test4a="01234567012345670123456701234567"
    test4b="01234567012345670123456701234567"
    test4="${test4a}${test4b}${test4a}${test4b}${test4a}${test4b}${test4a}${test4b}${test4a}${test4b}${test4a}${test4b}${test4a}${test4b}${test4a}${test4b}${test4a}${test4b}${test4a}${test4b}"

    test7_1="49b2aec2594bbe3a3b117542d94ac8"
    test8_1="9a7dfdf1ecead06ed646aa55fe757146"
    test9_1="65f932995ba4ce2cb1b4a2e71ae70220aacec8962dd4499cbd7c887a94eaaa101ea5aabc529b4e7e43665a5af2cd03fe678ea6a5005bba3b082204c28b9109f469dac92aaab3aa7c11a1b32a"
    test10_1="f78f92141bcd170ae89b4fba15a1d59f3fd84d223c9251bdacbbae61d05ed115a06a7ce117b7beead24421ded9c32592bd57edeae39c39fa1fe8946a84d0cf1f7beead1713e2e0959897347f67c80b0400c209815d6b10a683836fd5562a56cab1a28e81b6576654631cf16566b86e3b33a108b05307c00aff14a768ed7350606a0f85e6a91d396f5b5cbe577f9b38807c7d523d6d792f6ebc24a4ecf2b3a427cdbbfb"
    test7_224="f07006f25a0bea68cd76a29587c28d"
    test8_224="18804005dd4fbd1556299d6f9d93df62"
    test9_224="a2be6e463281090294d9ce94826569423a3a305ed5e2116cd4a4c987fc0657006491b149ccd4b51130ac62b19dc248c744543d20cd3952dced1f06cc3b18b91f3f55633ecc3085f4907060d2"
    test10_224="55b210079c61b53add520622d1ac97d5cdbe8cb33aa0ae344517bee4d7ba09abc8533c5250887a43bebbac906c2e1837f26b36a59ae3be7814d506896b718b2a383ecdac16b96125553f416ff32c6674c74599a9005386d9ce1112245f48ee470d396c1ed63b92670ca56ec84deea814b6135eca54392bdedb9489bc9b875a8baf0dc1ae785736914ab7daa264bc079d269f2c0d7eddd810a426145a0776f67c878273"
    test7_256="be2746c6db52765fdb2f88700f9a73"
    test8_256="e3d72570dcdd787ce3887ab2cd684652"
    test9_256="3e740371c810c2b99fc04e804907ef7cf26be28b57cb58a3e2f3c007166e49c12e9ba34c0104069129ea7615642545703a2bd901e16eb0e05deba014ebff6406a07d54364eff742da779b0b3"
    test10_256="8326754e2277372f4fc12b20527afef04d8a056971b11ad57123a7c137760000d7bef6f3c1f7a9083aa39d810db310777dab8b1e7f02b84a26c773325f8b2374de7a4b5a58cb5c5cf35bcee6fb946e5bd694fa593a8beb3f9d6592ecedaa66ca82a29d0c51bcf9336230e5d784e4c0a43f8d79a30a165cbabe452b774b9c7109a97d138f129228966f6c0adc106aad5a9fdd30825769b2c671af6759df28eb393d54d6"
    test7_384="8bc500c77ceed9879da989107ce0aa"
    test8_384="a41c497779c0375ff10a7f4e08591739"
    test9_384="68f501792dea9796767022d93da71679309920fa1012aea357b2b1331d40a1d03c41c240b3c9a75b4892f4c0724b68c875321ab8cfe5023bd375bc0f94bd89fe04f297105d7b82ffc0021aeb1ccb674f5244ea3497de26a4191c5f62e5e9a2d8082f0551f4a5306826e91cc006ce1bf60ff719d42fa521c871cd2394d96ef4468f21966b41f2ba80c26e83a9"
    test10_384="399669e28f6b9c6dbcbb6912ec10ffcf74790349b7dc8fbe4a8e7b3b5621db0f3e7dc87f823264bbe40d1811c9ea2061e1c84ad10a23fac1727e7202fc3f5042e6bf58cba8a2746e1f64f9b9ea352c711507053cf4e5339d52865f25cc22b5e87784a12fc961d66cb6e89573199a2ce6565cbdf13dca403832cfcb0e8b7211e83af32a11ac17929ff1c073a51cc027aaedeff85aad7c2b7c5a803e2404d96d2a77357bda1a6daeed17151cb9bc5125a422e941de0ca0fc5011c23ecffefdd09676711cf3db0a3440720e1615c1f22fbc3c721de521e1b99ba1bd5577408642147ed096"
    test7_512="08ecb52ebae1f7422db62bcd542670"
    test8_512="8d4e3c0e3889191491816e9d98bff0a0"
    test9_512="3addec85593216d1619aa02d9756970bfc70ace2744f7c6b2788151028f7b6a2550fd74a7e6e69c2c9b45fc454966dc31d2e10da1f95ce02beb4bf8765574cbd6e8337ef420adc98c15cb6d5e4a0241ba0046d250e510231cac2046c991606ab4ee4145bee2ff4bb123aab498d9d44794f99ccad89a9a1621259eda70a5b6dd4bdd87778c9043b9384f54906"
    test10_512="a55f20c411aad132807a502d65824e31a2305432aa3d06d3e282a8d84e0de1de6974bf495469fc7f338f8054d58c26c49360c3e87af56523acf6d89d03e56ff2f868002bc3e431edc44df2f0223d4bb3b243586e1a7d924936694fcbbaf88d9519e4eb50a644f8e4f95eb0ea95bc4465c8821aacd2fe15ab4981164bbb6dc32f969087a145b0d9cc9c67c22b763299419cc4128be9a077b3ace634064e6d99283513dc06e7515d0d73132e9a0dc6d3b1f8b246f1a98a3fc72941b1e3bb2098e8bf16f268d64f0b0f4707fe1ea1a1791ba2f3c0c758e5f551863a96c949ad47d7fb40d2"
    sha1_seed="d0569cb3665a8a43eb6ea23d75a3c4d2054a0d7d"
    # sha224_seed="d0569cb3665a8a43eb6ea23d75a3c4d2054a0d7d66a9ca99c9ceb027"
    # sha256_seed="f41ece2613e4573915696b5adcd51ca328be3bf566a9ca99c9ceb0279c1cb0a7"
    # sha384_seed="8240bc51e4ec7ef76d18e35204a19f51a5213a73a81d6f944680d3075948b7e463804ea3d26e13ea820d65a484be7453"
    # sha512_seed="473ff1b9b3ffdfa126699ac7ef9e8e787773095824c642557c1399d98e4220448dc35b99bfdd44779543924c1ce93bc5941538895db988261b00774b12272039"

    testr160_1=''
    testr160_2="${test3}"
    testr160_3="${test1}"
    testr160_4="message_digest"
    testr160_5="abcdefghijklmnopqrstuvwxyz"
    testr160_6="${test2_1}"
    testr160_7="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"
    testr160_8="12345678901234567890123456789012345678901234567890123456789012345678901234567890"
    testr160_9="a" # 1000000 times

    testhash160_1="02be44f6e14cccfb4788cbfb21593d29724978903ee7f6956f39650ea54cdd83ea"
    testhash160_2="0434417dd8d89deaf0f6481c2c160d6de0921624ef7b956f38eef9ed4a64e36877be84b77cdee5a8d92b7d93694f89c3011bf1cbdf4fd7d8ca13b58a7bb4ab0804"
    testhash160_3="042873146dbf5e07dc70e50dfd57d038755f867e94a2b7057c0ed96710a7cbd9e75726e38e9dad51928ddd295a11a146326849bdac240b75f22762b3ab306ca6c4"
    testhash160_4="04be6d78328c89f690d8b15aea37a3a521c6705ac802fbec375e8b0d3613a0e895a09b806ac7fd3dd72f33f15a664316d09cac78e11310e594f5ac02547356fdd4"
    testhash160_5="045dc42e9f8a1ea38a724a16a37f5bcd963f500c66320fd9a74c1e6289bcc93ab89c45a328cc73e5933d4e8bee09a586867d016f7d6c0b5a4344e77f5874a8fe8b"
    testhash160_6="04778f93e3cf4db394e21947771e0bceb5950440432bff63b50b35dd0f7303b243cade6bea4b92972018140786c4585d8b345361b90b4c1db01d2e9cef01048fda"
    testhash160_7="038f2509aa74043da42707b1e425a41429bc105e24511f9841536d5c659f099354"

    testhash256_1="0100000000000000000000000000000000000000000000000000000000000000000000003ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4a29ab5f49ffff001d1dac2b7c"
    testhash256_2="0100000001c997a5e56e104102fa209c6a852dd90660a20b2d9c352423edce25857fcd3704000000004847304402204e45e16932b8af514961a1d3a1a25fdf3f4f7732e9d624c6c61548ab5fb8cd410220181522ec8eca07de4860a4acdd12909d831cc56cbbac4622082221a8768d1d0901ffffffff0200ca9a3b00000000434104ae1a62fe09c5f51b13905f07f06b99a2f7159b2225f374cd378d71302fa28414e7aab37397f554a7df5f142c21c1b7303b8a0626f1baded5c72a704f7e6cd84cac00286bee0000000043410411db93e1dcdb8a016b49840f8c53bc1eb68a382e97b1482ecad7b148a6909a5cb2e0eaddfb84ccf9744464f82e160bfa9b8b64f9d4c03f999b8643f656b412a3ac00000000"
    testhash256_3="0100000001f6ea284ec7521f8a7d094a6cf4e6873098b90f90725ffd372b343189d7a4089c0100000026255121029b6d2c97b8b7c718c325d7be3ac30f7c9d67651bce0c929f55ee77ce58efcf8451aeffffffff0130570500000000001976a9145a3acbc7bbcc97c5ff16f5909c9d7d3fadb293a888ac00000000"
    testhash256_4="040000000edfc483c8413a405bf1d54944e6a5f38138ae400785fb0600000000000000004b06dcf691c3ecf5ddb88c5b42c74695715eb37bc42a20064c6bda679f21e9e7e9f96e564fe60d1882921919"
}

tests_arr
tests_ret
