#!/usr/bin/bc

define void testhmac(){

    auto knw, key, msg;

    print "Testing hmac()\n";
    # set_hmac_pads(sha256_block_len);
    set_hmac_sha256();

    key = 0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B;
    knw = 1;
    hmac(knw,key,sha256_block_len);
    # 0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    # 57575757575757575757575757575757575757575C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C
    # 3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3636363636363636363636363636363636363636363636363636363636363636363636363636363636363636

    print "\n";
    key = 4A656665;
    knw = 0;
    hmac(knw,key,sha256_block_len);
    # 4A656665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    # 16393A395C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C
    # 7C535053363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636

    print "\n";
    key = AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA;
    knw = 0;
    hmac(knw,key,sha256_block_len);
    # AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    # F6F6F6F6F6F6F6F6F6F6F6F6F6F6F6F6F6F6F6F65C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C
    # 9C9C9C9C9C9C9C9C9C9C9C9C9C9C9C9C9C9C9C9C3636363636363636363636363636363636363636363636363636363636363636363636363636363636363636
    
    print "\n";
    key = 0102030405060708090A0B0C0D0E0F10111213141516171819;
    knw = 1;
    hmac(knw,key,sha256_block_len);
    # 0102030405060708090A0B0C0D0E0F10111213141516171819000000000000000000000000000000000000000000000000000000000000000000000000000000
    # 5D5E5F58595A5B54555657505152534C4D4E4F48494A4B44455C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C
    # 373435323330313E3F3C3D3A3B383926272425222320212E2F363636363636363636363636363636363636363636363636363636363636363636363636363636

    print "\n";
    key = 0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C;
    knw = 1;
    hmac(knw,key,sha256_block_len);
    # 0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    # 50505050505050505050505050505050505050505C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C
    # 3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3636363636363636363636363636363636363636363636363636363636363636363636363636363636363636

    # hash256(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA)
    print "\n";
    key = 45AD4B37C6E2FC0A2CFCC1B5DA524132EC707615C2CAE1DBBC43C97AA521DB81;
    knw = 0;
    hmac(knw,key,sha256_block_len);
    # 45AD4B37C6E2FC0A2CFCC1B5DA524132EC707615C2CAE1DBBC43C97AA521DB810000000000000000000000000000000000000000000000000000000000000000
    # 19F1176B9ABEA05670A09DE9860E1D6EB02C2A499E96BD87E01F9526F97D87DD5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C
    # 739B7D01F0D4CA3C1ACAF783EC647704DA464023F4FCD7ED8A75FF4C9317EDB73636363636363636363636363636363636363636363636363636363636363636
}
testhmac(); 
